@{
    ViewBag.Title = "Matrícula";
    Layout = "~/Views/Shared/_layout.cshtml";
}

@section head {
    <link rel="stylesheet" href="~/Content/themes/base/dojo1.8.5r/dojox/calendar/themes/claro/Calendar.css">
}

@section scripts {
    @Scripts.Render("~/bundles/cadEnderecoAux")
    <script src="~/Scripts/jquery.maskedinput-1.3.js"></script>
    @Scripts.Render("~/bundles/matricula")
    @Scripts.Render("~/bundles/cadMatriculaPartial")
    @Scripts.Render("~/bundles/turmaFK")
    @Scripts.Render("~/bundles/logradouroFK")
}

@section scriptsBody{
    <script type="text/javascript">
        document.getElementById("labelTitulos").innerHTML = "Matrícula";
        //**** Requerires para a Tabulação ****\\
        require([
                "dojo/NodeList-traverse",
                "dijit/form/TextBox",
                "dijit/Dialog",
                "dijit/form/Select",
                "dojo/_base/event",
                "dojox/validate/web",
                "dojox/validate/check",
                "dijit/form/NumberTextBox",
                "dijit/form/ValidationTextBox",
                "dijit/form/Form",
                "dojox/form/Manager",
                "dijit/Tooltip",
                "dijit/form/TimeTextBox",
                "dojo/data/ObjectStore"
        ]);
        montarCadastroMatricula('@Permissoes');

    </script>
}


<style>

    .positionMatricula {
        width: 900px;
        max-width:900px;
        height: 700px;
    }
/*  @@media (min-width: 1024px) {
        .positionMatricula {
            width: 900px;
            max-width:900px;
            height: 800px;
        }
    }
@@media (min-width: 720px) and (max-width: 1023px) {
        .positionMatricula {
            width: 700px;
            max-width:700px;
            height: 800px;
        }
    }*/

</style>
<div id="container">
    <input type="hidden" id="link" value="" />
    <div class="apresentadorMsg" id="apresentadorMensagem" style="display:none;"></div>
    <script type="text/javascript">
        showCarregando();
    </script>

    @*Criação da Pesquisa*@
    <div class="EspacoCaixa caixaPesquisa">
        <input type="hidden" id="setValuePermissoes" value="" />
        <table class="Table">
            <tr>
                <td style="width: 95%;">
                    <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Filtros'" id="panePesqGeral" open="true">
                        <table id="tableConceito" class="table">
                            <tr style="vertical-align: middle;">
                                <td class="tdRight" style="width: 10%;">
                                    <label for="_aluno">Aluno:</label></td>
                                <td style="width: 20%;" class="dojoTextBoxIECorrect">
                                    <input type="text" id="_aluno" name="_aluno" style="width: 100%;" data-dojo-type="dijit/form/TextBox" /></td>
                                <td class="tdRight" style="width: 10%;">
                                    <label for="_turma">Turma:</label></td>
                                <td class="dojoTextBoxIECorrect" style="width: 20%;">
                                    <input type="text" id="_turma" name="_turma" style="width: 100%;" data-dojo-type="dijit/form/TextBox" /></td>
                                <td class="tdRight" style="width: 7%;">
                                    <label for="inicioAlunoTurma">Início:</label></td>
                                <td class="dojoTextBoxIECorrect" style="width: 10%;">
                                    <input type="checkbox" id="inicioAlunoTurma" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                            </tr>
                            <tr class="Pesquisa">
                                <td class="tdRight" style="width: 10%;">
                                    <label>Situação:</label></td>
                                <td>
                                    <input type="text" id="situacao" name="situacao" />
                                </td>
                                <td class="tdRight" style="width: 10%;">
                                    <label>Contrato:</label></td>
                                <td>
                                    <table>
                                        <tr>
                                            <td>
                                                <input type="text" id="_contrato" name="_contrato" size="11" style="width: 90%;" onkeypress="mascaraInt(document.getElementById('_contrato'));"
                                                       data-dojo-type="dijit/form/NumberSpinner" maxlength="9" data-dojo-props="smallDelta:1, constraints:{min:1,max:900000000,places:0,pattern:'000000000'}" />
                                            </td>
                                            <td class="tdRight" style="width: 20%;" id="tdLblMatricula">
                                                <label>Matrícula:</label></td>
                                            <td class="dojoTextBoxIECorrect" id="tdCampMatricula">
                                                <input type="text" id="nm_matricula_pesq" name="nm_matricula_pesq" size="11" style="width: 100%;" onkeypress="mascaraInt(document.getElementById('nm_matricula_pesq'));"
                                                    data-dojo-type="dijit/form/NumberSpinner" maxlength="9" data-dojo-props="smallDelta:1, constraints:{min:1,max:900000000,places:0,pattern:'000000000'}" />
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 13%;">
                                    <label for="_tipo">Tipo:</label>
                                </td>
                                <td colspan="2" class="dojoTextBoxIECorrect">
                                    <form id="_tipocontrato" data-dojo-type="dojox/form/Manager">
                                        <input id="_tipo" name="_tipo" class="alignDojoData" style="width: 100%;" />
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td class="tdRight" style="width: 10%;">
                                    <label>Ano Escolar:</label>
                                </td>
                                <td>
                                    <input id="pesqAnoEscolar" name="pesqAnoEscolar" data-dojo-type="dijit/form/FilteringSelect" required="required" style="width: 100%;" maxlength="10" />
                                </td>
                            </tr>
                        </table>
                        <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Diversos'" id="paDiversos" open="true">
                            <table class="Table">
                                <tr>
                                    <td class="tdRight nowrap" style="width: 13%;">
                                        <label for="ckSemTurma">Sem Turma:</label></td>
                                    <td class="dojoTextBoxIECorrect" style="width: 20%;">
                                        <input type="checkbox" id="ckSemTurma" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                    <td class="tdRight" style="width: 13%;" id ="tdCkRenegociarLabel">
                                        <label for="ckRenegociar" >Renegociação:</label></td>
                                    <td class="dojoTextBoxIECorrect" style="width: 20%;"  id ="tdCkRenegociar">
                                        <input type="checkbox" id="ckRenegociar" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                    <td class="tdRight" style="width: 13%;">
                                        <label for="ckTransferir">Transferência:</label></td>
                                    <td class="dojoTextBoxIECorrect" style="width: 20%;">
                                        <input type="checkbox" id="ckTransferir" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                    <td class="tdRight" style="width: 13%;">
                                        <label for="ckRetorno">Retorno:</label></td>
                                    <td class="dojoTextBoxIECorrect" style="width: 20%;">
                                        <input type="checkbox" id="ckRetorno" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                    <td class="tdRight" style="width: 7%;">
										<label for="ckVirada">Virada(Rematricula):</label></td>
										<td class="dojoTextBoxIECorrect" style="width: 10%;">
											<input type="checkbox" id="ckVirada" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                </tr>
                                <tr>
                                    <td class="tdRight" style="width: 13%">
                                        <label for="cd_nome_contrato_pesq">Layout: </label>
                                    </td>
                                    <td style="width: 20%" class="dojoTextBoxIECorrect">
                                        <input data-dojo-type="dijit/form/FilteringSelect" style="width: 100%;" id="cd_nome_contrato_pesq" name="cd_nome_contrato_pesq" />
                                    </td>
                                    <td class="tdRight" style="width: 13%">
                                        <label for="tipoContrato">Tipo Contrato: </label>
                                    </td>
                                    <td style="width: 20%" class="dojoTextBoxIECorrect">
                                        <input data-dojo-type="dijit/form/FilteringSelect" style="width: 70%;" id="tipoContrato" name="tipoContrato" />
                                    </td>
                                    <td class="tdRight" style="width: 10%;">
                                        <label for="statusAluno" style="width: 100%;">Status Alunos:</label>
                                    </td>
                                    <td style="width: 13%;" class="dojoTextBoxIECorrect">
                                        <input id="statusAluno" class="margemCampoEsq" />
                                    </td>
                                    <td class="tdRight" style="width: 10%;">
                                        <label>Vinculado:</label></td>
                                    <td class="dojoTextBoxIECorrect" style="width: 10%;">
                                        <input type="text" id="_tipoVinculado" name="_tipoVinculado" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Período'" id="paneDatas" open="false">
                            <table class="Table">
                                <tr style="vertical-align: middle;">
                                    <td class="tdRight nowrap" style="width: 10%">
                                        <label for="dtaInicial">Data Inicial:</label>
                                    </td>
                                    <td style="width: 25%" class="dojoTextBoxIECorrect">
                                        <input 
                                            type="text" 
                                            id="dtaInicial" 
                                            name="dtaInicial" 
                                            data-dojo-type="dijit.form.DateTextBox" class="alignDojoData" style="width: 100%;" 
                                            onkeypress="mascaraDataHora(event, this)" maxlength="10" />
                                    </td>
                                    <td class="tdRight nowrap" style="width: 10%">
                                        <label for="dtaInicial" class="AlinhaDireita">Data Final:</label>
                                    </td>
                                    <td style="width: 25%" class="dojoTextBoxIECorrect">
                                        <input 
                                            type="text" 
                                            id="dtaFinal" 
                                            data-dojo-type="dijit.form.DateTextBox" 
                                            class="alignDojoData" style="width: 100%;"
                                            onkeypress="mascaraDataHora(event, this)" maxlength="10"/>
                                    </td>
                                    <td class="tdRight" style="width: 25%">
                                        <table id="tbPeriodo" class="table">
                                            <tr style="vertical-align: middle;">
                                                <td class="tdRight" style="width: 7%;">
                                                    <label for="ckDtaMatricula">Matrícula:</label></td>
                                                <td class="dojoTextBoxIECorrect" style="width: 1%;">
                                                    <input type="checkbox" id="ckDtaMatricula" data-dojo-type="dijit/form/CheckBox" class="Check" checked="true" /></td>
                                                <td class="tdRight" style="width: 7%;">
                                                    <label for="ckDtaInicial">Inicial:</label></td>
                                                <td class="dojoTextBoxIECorrect" style="width: 1%;">
                                                    <input type="checkbox" id="ckDtaInicial" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                                <td class="tdRight" style="width: 7%;">
                                                    <label for="ckDtaFinal">Final:</label></td>
                                                <td class="dojoTextBoxIECorrect" style="width: 1%;">
                                                    <input type="checkbox" id="ckDtaFinal" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
                <td style="width: 5%; text-align: center">
                    <input id="pesquisarMatricula" />
                </td>
            </tr>
        </table>

    </div>
    @*Criação barra de ação*@
    <div style="padding-top: 10px">
        <div class="linha_acoes" style="width: 100%"></div>
        <div>
            <table style="width: 100%" class="Alinhamento">
                <tr style="width: 100%">
                    <td style="text-align: left; width: 25%">
                        <div class="linkAcoes" id="linkAcoes"></div>
                    </td>
                    <td style="text-align: center; width: 50%">
                        <input id="novaMatricula" title="Novo" />
                        <input id="relatorioMatricula" title="Relatório" />
                    </td>
                    <td style="text-align: right; width: 25%">
                        <span class="linkSelecionados" id="linkSelecionadosMatricula"></span>
                    </td>
                </tr>
            </table>
        </div>
        <div class="linha_acoes" style="width: 100%"></div>
    </div>
    @*Criação da grade*@
    <div data-dojo-type="dijit/layout/ContentPane" style="padding-left: 0px; width: 100%">
        <div class="gridCadBasic">
            <div id="gridMatricula"></div>
        </div>
    </div>
</div>
@*<div id="cadMatricula" data-dojo-type="dijit/Dialog" title="Cadastro de Matrícula" class="positionMatricula" >*@
<div id="cadMatricula" data-dojo-type="dijit/Dialog" title="Cadastro de Matrícula" style="display: none; max-width: 900px;width: 900px">

    <div class="sessao_form" style="margin-left: -10px;">
        <span id="counter_form_2">Sua sess&atilde;o expira em 59 min 59 seg</span>
    </div>

    @Html.Partial("../Secretaria/CadMatriculaPartial")
</div>

<div id="proLogradouroFK" data-dojo-type="dijit.Dialog" title="Pesquisar Logradouros" style="display: none; width: 760px;">
   <div style="width:745px;padding-bottom:15px;">
        @Html.Partial("../Pessoa/LogradouroFK")
    </div>
</div>

@*Dilog carnê*@
<div data-dojo-type="dijit/Dialog" data-dojo-id="dialogGerarCarne" id="dialogGerarCarne" title="Carnê">
    <table class="dijitDialogPaneContentArea">
        <tr>
            <td><label for="name">Imprimir Capa:</label></td>
            <td><input checked type="checkbox" id="imprimirCapaCarne" data-dojo-type="dijit/form/CheckBox" class="Check" /></td>
        </tr>
        <tr>
            <td><label for="address">Parcelas:</label></td>
            <td>
                <input data-dojo-type="dijit/form/TextBox" name="parcIniCarne" id="parcIniCarne" value="" 
                       style="width: 31.5%;" required="false" maxlength="6" onkeypress="mascaraInt(document.getElementById('parcIniCarne'));"/>
                <label style="margin-left: 1%;">a</label>
                <input data-dojo-type="dijit/form/TextBox" name="parcFimCarne" id="parcFimCarne" value="" style="width: 31.5%;" 
                       required="false" maxlength="6" onkeypress="mascaraInt(document.getElementById('parcFimCarne'));"/>
            </td>
        </tr>
    </table>

    @*Criação barra de ação*@
    <div style="padding-top: 10px">
        <div class="linha_acoes" style="width: 100%"></div>
        <div>
            <table style="width: 100%" class="Alinhamento">
                <tr style="width: 100%">                  
                    <td style="text-align: center; width: 50%">
                        <input id="visulizarCarne" title="Visualizar" />
                        <input id="fecharDialogCarne" title="Cancelar" />
                    </td>                
                </tr>
            </table>
        </div>
        <div>
            <label style="color: red">Obs: Se o número de parcelas não for informado, irá imprimir todas.</label>
        </div>
        <div class="linha_acoes" style="width: 100%"></div>
    </div>
</div>


<div data-dojo-type="dijit/Dialog" data-dojo-id="dialogEnviarEmailAlunoRaf" id="dialogEnviarEmailAlunoRaf" title="Enviar email aluno Raf" style="width: 500px;">
    <div class="apresentadorMsg" id="apresentadorMensagemEnviarEmailAlunoRaf" style="display: none;"></div>
    <div class="linha_acoes" style="width: 100%"></div>
    <table class="dijitDialogPaneContentArea" style="width: 100%">

        <input type="hidden" id="cd_pessoa_raf_email" value="0" />
        <input type="hidden" id="raf_cd_pessoa_email" value="0" />
        <input type="hidden" id="email_aluno_envio_raf"  />
        <tr>
            <td class="Pesquisa tdRight" style="width: 1%">
                <label id="lbNmRafEmail" class="AlinhaDireita nowrap">Número RAF:</label>
            </td>
            <td style="width: 32%;" class="dojoTextBoxIECorrect">
                <input type="text" id="nmRafEmail" name="NmRaf" style="width: 100%;" data-dojo-type="dijit/form/TextBox" maxlength="125" />
            </td>
            <td class="tdRight" style="width: 5%">
                <label>Liberado:</label>
            </td>
            <td style="width: 1%; text-align: left">
                <input name="ckLiberadoRafEmail" type="checkbox" id="ckLiberadoRafEmail" data-dojo-type="dijit/form/CheckBox" />
            </td>

        </tr>
        <tr>
            <td class="Pesquisa tdRight" style="width: 1%">
                <label id="lbBloqueadoRafEmail" class="AlinhaDireita nowrap">Bloqueado:</label>
            </td>
            <td style="width: 1%; text-align: left">
                <input name="ckBloqueadoRafEmail" type="checkbox" id="ckBloqueadoRafEmail" data-dojo-type="dijit/form/CheckBox" />
            </td>
            <td class="tdRight" style="width: 5%">
                <label>Trocar Senha:</label>
            </td>
            <td style="width: 1%; text-align: left">
                <input name="ckTrocarSenhaRafEmail" type="checkbox" id="ckTrocarSenhaRafEmail" data-dojo-type="dijit/form/CheckBox" />
            </td>

        </tr>
        <tr>
            <td class="tdRight" style="width: 15%">
                <label id="lbNumeroTentativasRafEmail">Número de tentativas:</label>
            </td>
            <td colspan="1" style="width: 1%; text-align: left" class="dojoTextBoxIECorrect nowrap">
                <input type="text" id="nmTentativasRafEmail" name="nmTentativasRafEmail" required="false"
                       data-dojo-type="dijit/form/NumberSpinner" onkeypress="mascaraInt(document.getElementById('nmTentativas'));"
                       data-dojo-props="smallDelta:1, constraints:{min:0,max:5,places:0,pattern:'0'}, style: 'width:50px'" />
            </td>
            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">
                <label>Data de Expiração Senha:</label>
            </td>
            <td style="width: 30%">
                <input type="text" id="dt_expiracao_senhaRafEmail" constraints="{min:'1900-01', max:'2079-06', datePattern:'dd/MM/yyyy'}" name="dt_expiracao_senha" data-dojo-type="dijit.form.DateTextBox" style="width: 100%;" />
            </td>

        </tr>
        


    </table>

    @*Criação barra de ação*@
    <div style="padding-top: 10px">
        <div class="linha_acoes" style="width: 100%"></div>
        <div>
            <table style="width: 100%" class="Alinhamento">
                <tr style="width: 100%">
                    <td style="text-align: center; width: 50%">
                        <input id="enviarEmailRafAluno" title="Vincular" />
                        <input id="fecharDialogEnviarEmailRafAluno" title="Fechar" />
                    </td>
                </tr>
            </table>
        </div>

        <div class="linha_acoes" style="width: 100%"></div>
    </div>
</div>

<div id="fkPessoaPesq" data-dojo-type="dijit.Dialog" title="Pesquisar Pessoa" style="display: none; width: 800px; height: 590px;">
    <div style="height:590px;width:780px">
        @Html.Partial("../Pessoa/PessoaFK")
    </div>
</div>