@{
    ViewBag.Title = "Local de Movimento";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section scripts{
    @Scripts.Render("~/bundles/localmovto")
    <script src="~/Scripts/jquery.maskedinput-1.3.js"></script>
    @Scripts.Render("~/bundles/pessoaFK")
}

@section scriptsBody{
    <script type="text/javascript">
        document.getElementById("labelTitulos").innerHTML = "Local de Movimento";

        //**** Requerires para a Tabulação ****\\
        require([
                "dojo/NodeList-traverse",
                "dojo/_base/event",
                "dojox/validate/web",
                "dojox/validate/check",
                "dijit/form/NumberTextBox",
                "dijit/form/ValidationTextBox",
                "dijit/form/Form",
                "dojox/form/Manager",
                "dijit/form/CheckBox"
        ]);
        montarCadastroLocalMovto();
    </script>
}

<div style="width: 100%;">
    <input type="hidden" id="link" value="" />
    <div class="apresentadorMsg" id="apresentadorMensagem" style="display: none;"></div>
    <script type="text/javascript">
        showCarregando();
    </script>
    <div class="EspacoCaixa caixaPesquisa">
        <table class="Table">
            <tr>
                <td style="width: 95%;">
                    <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Filtros'" id="panePesqGeral" open="true">
                        <table class="Table">
                            <tr>
                                <td class="Pesquisa tdRight" style="width: 5%">
                                    <label for="descLocalMovto" class="AlinhaDireita">Nome:</label>
                                </td>
                                <td class="dojoTextBoxIECorrect" style="width: 30%;">
                                    <input id="descLocalMovto" maxlength="128" type="text" data-dojo-type="dijit/form/TextBox" class="campoGrande" style="width: 100%">
                                </td>
                                <td class="Pesquisa tdRight" style="width: 5%">
                                    <label for="descBanco" class="AlinhaDireita">Banco:</label>
                                </td>
                                <td class="dojoTextBoxIECorrect" style="width: 10%;">
                                    <input id="descBanco" required="false"
                                        style="width: 100%;"
                                        maxlength="3"
                                        data-dojo-type="dijit/form/TextBox"
                                        onkeypress="mascaraInt(document.getElementById('descBanco'));" />
                                </td>

                                <td class="tdRight" style="width: 3%">
                                    <label class="AlinhaDireita;" for="inicioLocalMovto">Início:</label>
                                </td>
                                <td style="width: 5%" class="dojoTextBoxIECorrect">
                                    <input type="checkbox" id="inicioLocalMovto" data-dojo-type="dijit/form/CheckBox" class="margemCampoEsq" />
                                </td>
                                <td class="tdRight" style="width: 5%">
                                    <label for="statusLocalMovto" class="AlinhaDireita;">Status:</label>
                                </td>
                                <td style="width: 5%;" class="dojoTextBoxIECorrect">
                                    <input id="statusLocalMovto" class="margemCampoEsq">
                                </td>
                                <td class="tdRight" style="width: 5%">
                                    <label for="tipoLocalMovto">Tipo: </label>
                                </td>
                                <td style="width: 10%">
                                    <input id="tipoLocalMovto" name="tipoLocalMovto" class="alignDojoData" style="width: 100%;" />
                                </td>
                            </tr>
                            <tr>
                                <td class="Pesquisa tdRight" style="width: 5%">
                                    <label for="noPessoaLocalMovto" class="AlinhaDireita">Pessoa:</label>
                                </td>
                                <td class="dojoTextBoxIECorrect" style="width: 30%;">
                                    <input id="noPessoaLocalMovto" maxlength="128" type="text" data-dojo-type="dijit/form/TextBox" class="campoGrande" style="width: 100%">
                                </td>
                                <td colspan="5"></td>
                            </tr>
                        </table>
                    </div>
                </td>
                <td style="width: 5%; text-align: center">
                    <input id="pesquisarLocalMovto" title="Pesquisar" />
                </td>
            </tr>
        </table>
    </div>
    <div style="padding-top: 10px">
        <div class="linha_acoes" style="width: 100%"></div>
        <table style="width: 100%">
            <tr style="width: 100%">
                <td style="text-align: left; width: 25%">
                    <div class="linkAcoes" id="linkAcoesLocalMovto"></div>
                </td>
                <td style="text-align: center; width: 50%">
                    <input id="novoLocalMovto" title="Novo" />
                    <input id="relatorioLocalMovto" title="Relatório" />
                </td>
                <td style="text-align: right; width: 25%">
                    <span class="linkSelecionados" id="linkSelecionadosLocalMovto"></span>
                </td>
            </tr>
        </table>
        <div class="linha_acoes" style="width: 100%"></div>
    </div>
    <div data-dojo-type="dijit/layout/ContentPane" style="padding-left: 0px; width: 100%">
        <div class="gridCadBasic">
            <div id="gridLocalMovto"></div>
        </div>
    </div>
</div>


<div id="cadLocalMovto" data-dojo-type="dijit.Dialog" title="Cadastro de Local de Movimento" style="max-width: 727px; width: 100%;">

    <div class="sessao_form" style="margin-left: -8px;">
        <span id="counter_form">Sua sess&atilde;o expira em 59 min 59 seg</span>
    </div>

    <div class="corpo_interno">
        <div class="apresentadorMsg" id="apresentadorMensagemLocalMovto" style="display: none;"></div>
        <div style="min-height: 110px; max-height: 350px; height: 100%;" class="scroll">
            <form data-dojo-type="dojox/form/Manager" enctype="multipart/form-data" id="formLocalMovto" class="Formulario">
                <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Principal'" id="titPrincipal" open="true">
                    <input id="cd_local_movto" name="cd_local_movto" type="hidden" value="0" />
                    <table class="Table">
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">
                                <label for="nm_tipo_local">Tipo: </label>
                            </td>
                            <td colspan="3">
                                <table style="width: 100%">
                                    <tr>
                                        <td style="width: 22%">
                                            <input id="nm_tipo_local" name="nm_tipo_local" required="true" class="alignDojoData" style="width: 100%;" />
                                        </td>
                                        <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">
                                            <label for="cd_pessoa_local">Pessoa:</label>
                                        </td>
                                        <td class="CorpoFormAux nowrap" style="width: 100%">
                                            <input id="cd_pessoa_local" name="cd_pessoa_local" readonly="true" required="false" style="width: 80%;" data-dojo-type="dijit/form/TextBox">
                                            <input id="cadPessoaLocal" style="min-width: 18px;" />
                                            <input type="text" id="limparPessoaLocal" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">Nome:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 100%">
                                <input id="no_local_movto" maxlength="32"  name="no_local_movto" required="true" data-dojo-type="dijit/form/ValidationTextBox" style="width: 90%;" />
                            </td>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 20%;">Ativo:</td>
                            <td class="dojoTextBoxIECorrect">
                                <input id="id_local_ativo" name="id_local_ativo" data-dojo-type="dijit/form/CheckBox" checked="checked" />
                            </td>
                        </tr>
                    </table>
                </div>
            </form>
            <form data-dojo-type="dojox/form/Manager" enctype="multipart/form-data" id="formBancoLocalMovto" class="Formulario">
                <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Banco'" id="tBanco" open="true">
                    <table>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 20%">
                                <label for="cd_banco">Banco:</label>
                            </td>
                            <td style="width: 40%;" class="dojoTextBoxIECorrect nowrap">
                                <select id="cd_banco" data-dojo-type="dijit/form/FilteringSelect" style="width: 100%;" name="cd_banco" required="false"></select>
                            </td>
                            <td class="tdRight" style="width: 10%">Número:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 30%">
                                <input id="nm_banco" name="nm_banco"
                                    style="width: 100%;"
                                    maxlength="3"
                                    data-dojo-type="dijit/form/ValidationTextBox"
                                    onkeypress="mascaraInt(document.getElementById('nm_banco'));" />
                            </td>
                        </tr>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 20%;">Agência:</td>
                            <td class="dojoTextBoxIECorrect nowrap " style="width: 40%">
                                <input id="nm_agencia" name="nm_agencia"
                                    style="width: 80%;"
                                    maxlength="8"
                                    data-dojo-type="dijit/form/ValidationTextBox" />
                                <input id="nm_digito_agencia" name="nm_digito_agencia"
                                    style="width: 20%;"
                                    maxlength="2"
                                    data-dojo-type="dijit/form/ValidationTextBox"
                                    @*onkeypress="mascaraInt(document.getElementById('nm_digito_agencia'));" *@
                                    />
                            </td>
                            <td colspan="2">&nbsp;</td>
                        </tr>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 20%">Conta Corrente:</td>
                            <td class="dojoTextBoxIECorrect nowrap " style="width: 40%">
                                <input id="nm_conta_corrente" name="nm_conta_corrente"
                                    style="width: 80%;"
                                    maxlength="8"
                                    data-dojo-type="dijit/form/ValidationTextBox"
                                    onkeypress="mascaraInt(document.getElementById('nm_conta_corrente'));" />
                                <input id="nm_digito_conta_corrente" name="nm_digito_conta_corrente"
                                    style="width: 20%;"
                                    maxlength="2"
                                    data-dojo-type="dijit/form/ValidationTextBox"
                                   @* onkeypress="mascaraInt(document.getElementById('nm_digito_conta_corrente'));"*@
                                     />
                            </td>
                            <td colspan="2">
                                <table>
                                    <tr>   
                                        <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 35%">Operação da Conta:</td>
                                        <td style="width: 30%">
                                            <input id="nm_operacao_conta_corrente" name="nm_operacao_conta_corrente"
                                                style="width: 100%;"
                                                maxlength="2"
                                                data-dojo-type="dijit/form/ValidationTextBox"
                                                onkeypress="mascaraInt(document.getElementById('nm_operacao_conta_corrente'));" />
                                        </td>                         
                                        <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 35%;">C.Conjunta:&nbsp;
                                            <input id="id_conta_conjunta" name="id_conta_conjunta" data-dojo-type="dijit/form/CheckBox"
                                                onclick="toglleTagConjunta(this.checked);" />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">
                                <label for="pessoaBco">Pessoa Banco:</label>
                            </td>
                            <td colspan="3" class="CorpoFormAux nowrap" style="width: 100%">
                                <input id="cd_pessoa_banco" name="cd_pessoa_banco" required="false" style="width: 84%;" data-dojo-type="dijit/form/TextBox">
                                <input id="cadPessoaBco" style="min-width: 18px;" />
                                <input type="text" id="limparPessoaBco" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Cnab'" id="tCnab" open="false">
                    <table>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">Código Cliente:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 50%">
                                <input id="dc_num_cliente_banco" name="dc_num_cliente_banco" data-dojo-type="dijit/form/ValidationTextBox" style="width: 100%;" maxlength="16"/>
                            </td>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">Dígito Cliente:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 50%">
                                <input id="dc_digito_cedente" name="dc_digito_cedente" data-dojo-type="dijit/form/ValidationTextBox" style="width: 25%;" maxlength="3"
                                    onkeypress="mascaraInt(document.getElementById('dc_digito_cedente'));"//>
                            </td>
                            
                        </tr>
                        <tr>
                            <td class="tdRight">Nosso Número:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 30%">
                                <input 
                                    id="dc_nosso_numero" 
                                    maxlength="20" 
                                    name="dc_nosso_numero" 
                                    data-dojo-type="dijit/form/ValidationTextBox" 
                                    style="width: 100%;"
                                    onkeypress="mascaraInt(document.getElementById('dc_nosso_numero'));"/>
                            </td>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">Número Remessa:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 50%">
                                <input 
                                    id="nm_sequencia" 
                                    maxlength="9" 
                                    name="nm_sequencia" 
                                    data-dojo-type="dijit/form/ValidationTextBox" 
                                    style="width: 100%;"
                                    onkeypress="mascaraInt(document.getElementById('nm_sequencia'));"/>
                                
                            </td>
                            
                        </tr>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%">
                                <label>Carteira:</label>
                            </td>
                            <td style="width: 40%;" class="dojoTextBoxIECorrect nowrap">
                                <select id="cbCarteira" data-dojo-type="dijit/form/FilteringSelect" style="width: 100%;" required="false"></select>
                            </td>
                            <td class="CorpoFormAux AlinhaDireita nowrap">Código Transmissão:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 30%">
                                <input id="nm_transmissao" maxlength="32" name="nm_transmissao" data-dojo-type="dijit/form/ValidationTextBox" style="width: 100%;" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Conta Conjunta'" id="tConjunta" open="true">
                    <table>
                        <tr>
                            <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">Nome:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 50%">
                                <input id="dc_pessoa_conjunta" name="dc_pessoa_conjunta" data-dojo-type="dijit/form/ValidationTextBox" style="width: 100%;" />
                            </td>
                            <td class="tdRight">CPF:</td>
                            <td class="dojoTextBoxIECorrect" style="width: 30%">
                                <input id="dc_cpf_pessoa_conjunta" name="dc_cpf_pessoa_conjunta" data-dojo-type="dijit/form/ValidationTextBox" style="width: 100%;" />
                            </td>
                        </tr>
                    </table>
                </div>
                <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Taxas Bancárias'" id="tTaxa" open="false">
					<table>
						<tr>
							<td class="CorpoFormAux AlinhaDireita nowrap" style="width: 5%;">
								<label for="lista_locais_movto_banco">Banco:</label>
							</td>
                             <td style="width: 40%;" class="dojoTextBoxIECorrect nowrap">
                                <select id="lista_locais_movto_banco" data-dojo-type="dijit/form/FilteringSelect" style="width: 100%;" name="lista_locais_movto_banco" required="true"></select>
                            </td>
						</tr>
					</table>

                    <table style="width: 100%" class="Alinhamento">
                        <tr style="width: 100%">
                            <td style="text-align: left; width: 25%">
                                <div class="linkAcoes" id="linkTaxaBancaria"></div>
                            </td>
                            <td style="text-align: center; width: 50%">
                                <div id="btnAddTaxaBancaria"></div>
                            </td>
                            <td style="text-align: center; width: 25%">
                                <div style="text-align: right; width: 25%;"></div>
                            </td>
                        </tr>
                    </table>


                    <div class="linha_acoes" style="width: 100%"></div>
					<div style="height:100px">
						<div id="gridTaxa"></div>
					</div>
			    </div>
            </form>
        </div>
        <div class="CaixaAcao" style="padding-top: 5px;">
            <div class="linha_acoes" style="width: 100%"></div>
            <div class="Alinhamento">
                <span id="divIncluirLocalMovto">
                    <input id="incluirLocalMovto" title="incluir" /></span>
                <span id="divAlterarLocalMovto">
                    <input id="alterarLocalMovto" title="Alterar" /></span>
                <span id="divExcluirLocalMovto">
                    <input type="button" id="deleteLocalMovto" title="Apagar" /></span>
                <span id="divLimparLocalMovto">
                    <input id="limparLocalMovto" title="Limpar" /></span>
                <span id="divCancelarLocalMovto">
                    <input type="button" id="cancelarLocalMovto" title="Cancelar" /></span>
                <span id="divFecharLocalMovto">
                    <input type="button" id="fecharLocalMovto" title="Fechar" /></span>
            </div>
            <div class="linha_acoes" style="width: 100%"></div>
        </div>
    </div>

</div>

<div id="proPessoa" data-dojo-type="dijit.Dialog" title="Pesquisar Pessoa" style="display: none; width: 800px; height: 590px;">
    <div style="width: 785px; height: 590px;">
        @Html.Partial("../Pessoa/PessoaFK")
    </div>
</div>

<div id="proPessoaRel" data-dojo-type="dijit.Dialog" title="Pesquisar Pessoa" style="display: none; width: 800px; height: 590px;">
    <div style="width: 785px; height: 590px;">
        @Html.Partial("../Pessoa/pessoaRelFK")
    </div>
</div>

<div id="dialogTaxaBancaria" data-dojo-type="dijit/Dialog"  title="Incluir Taxa Bancária" style="width: 600px;">
	<div class="corpo_interno">
        <div class="apresentadorMsg" id="apresentadorMensagemTaxaBancaria" style="display: none;"></div>
        <input id="cd_taxa_bancaria" name="cd_taxa_bancaria" type="hidden" value="0" />
		<table style="width: 100%" class="Alinhamento">
			<tr style="width: 100%">
				<td class="tdRight" style="width:12%">Nº Parcelas:</td>
				<td style="width:20%" class="dojoTextBoxIECorrect">
                    <input
                        data-dojo-type="dijit/form/ValidationTextBox"
                        style="width: 100%;"
                        id="valParcela"
                        required="true"
                        value=""
                        maxlength="3"
                        data-dojo-props="smallDelta:1, constraints:{min:0,max:3,places:0,pattern:'0'}"
                        onkeypress="mascaraInt(document.getElementById('codigoIntegracao'));" />
				</td>

                <td class="tdRight" style="width:12%">Taxa(%):</td>
				<td style="width:20%" class="dojoTextBoxIECorrect">
                      <input id="valTaxa"
                        style="width: 100%;"
                        maxlength="6" value="100"
                        required="true"
                        data-dojo-type="dijit/form/NumberTextBox"
                        data-dojo-props="smallDelta:1, constraints:{min:0, pattern:'000.##', max:100}"
                        onkeypress="mascaraFloat(document.getElementById('valTaxa'));"
                        name="valTaxa" />
				</td>

                <td class="tdRight" style="width:12%">Prazo(D+):</td>
				<td style="width:20%" class="dojoTextBoxIECorrect">
                     <input
                        data-dojo-type="dijit/form/ValidationTextBox"
                        style="width: 100%;"
                        id="valPrazo"
                        required="true"
                        value=""
                        maxlength="3"
                        data-dojo-props="smallDelta:1, constraints:{min:0,max:3,places:0,pattern:'0'}"
                        onkeypress="mascaraInt(document.getElementById('valPrazo'));" />
				</td>
			</tr>
		</table>
		<div class="containerCrud">
			<div class="linha_acoes" style="width: 100%"></div>
			<div style="text-align: center">
				<span id="divIncluirTxBancaria">
					<input id="incluirTxBancaria" title="incluir" /></span>
                <span id="divAlterarTxBancaria">
					<input id="alterarTxBancaria" title="incluir" /></span>
                <span id="divExcluirTxBancaria">
                <input type="button" id="deleteTxBancaria" title="Apagar" /></span>
				<span id="divCancelarTxBancaria">
					<input type="button" id="cancelarTxBancaria" title="Cancelar" /></span>
				<span id="divLimparTxBancaria">
					<input id="limparTxBancaria" title="Limpar" /></span>
				<span id="divFecharTxBancaria">
				<input type="button" id="fecharTxBancaria" title="Fechar" /></span>
			</div>
			<div class="linha_acoes" style="width: 100%"></div>
		</div>
	</div>
</div>
