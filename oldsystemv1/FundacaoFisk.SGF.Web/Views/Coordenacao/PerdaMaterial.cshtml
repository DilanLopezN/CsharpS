@{
    ViewBag.Title = "Perda de Material";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section scripts{
    <script src="~/Scripts/jquery.maskedinput-1.3.js"></script>
    @Scripts.Render("~/bundles/perdaMaterial")
    @Scripts.Render("~/bundles/pessoaFK")
    @Scripts.Render("~/bundles/planoContasFK")

    @Scripts.Render("~/bundles/movimentoFK")
    @Scripts.Render("~/bundles/alunoFK")
}

@section scriptsBody{
    <script type="text/javascript">
        document.getElementById("labelTitulos").innerHTML = "Perda de Material";

        //**** Requerires para a Tabulação ****\\
        require([
            "dojo/NodeList-traverse",
            "dojo/_base/event",
            "dojox/validate/web",
            "dojox/validate/check",
            "dijit/form/NumberTextBox",
            "dijit/form/ValidationTextBox",
            "dijit/form/Form",
            "dojox/form/Manager",
            "dojo/data/ObjectStore",
            "dojo/parser"
        ]);
        montarCadastroPerdaMaterial();
    </script>
    <style>
        .dojoxGridMasterMessages {
            position: relative;
            padding: 0;
            text-align: center;
            background-color: white;
        }
    </style>
}

<div style="width: 100%;">
    <input type="hidden" id="link" value="" />
    <div class="apresentadorMsg" id="apresentadorMensagem" style="display:none;"></div>
    <script type="text/javascript">
        showCarregando();
    </script>
    <div class="EspacoCaixa caixaPesquisa">
        <table class="Table">
            <tr>
                <td style="width: 95%;">
                    <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Pesquisa'" id="panePesqGeral" open="true">
                        <table class="Table">
                            <tr class="Pesquisa">
                                <td class="tdRight" style="width:5%;">
                                    <label for="txAluno" id="lblFkAluno">Aluno:</label>
                                </td>
                                <td style="width: 45%;" class="nowrap">
                                    <input id="cdAluno" type="hidden" />
                                    <table class="Table">
                                        <tr>
                                            <td class="dojoTextBoxIECorrect" style="width: 95%;">
                                                <input type="text" id="txAluno" name="txAluno" disabled="disabled" style="width: 100%;" data-dojo-type="dijit/form/TextBox" />
                                            </td>
                                            <td style="width: 5%; text-align: left" class="nowrap">
                                                <input id="FKAluno" style="min-width: 18px" />
                                                <input type="text" id="limparAluno" />
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td class="tdRight" style="width: 10%;">
                                    <label>Contrato:</label></td>
                                <td>
                                    <input type="text" id="_contrato" name="_contrato" size="11" style="width: 90%;" onkeypress="mascaraInt(document.getElementById('_contrato'));"
                                           data-dojo-type="dijit/form/NumberSpinner" maxlength="9" data-dojo-props="smallDelta:1, constraints:{min:1,max:900000000,places:0,pattern:'000000000'}" />
                                </td>
                            </tr>
                            <tr class="Pesquisa">
                                <td class="tdRight" style="width:5%;">
                                    <label id="lbNotaDevolver">Movimento:</label>
                                </td>
                                <td style="width: 45%;" class="nowrap">
                                    <input id="cd_nfDev" type="hidden" value="0" />
                                    <input id="id_tipo_movimento" type="hidden" value="0" />
                                    <table class="Table">

                                        <td class="dojoTextBoxIECorrect" style="width: 95%;">
                                            <input id="tpNfDev" name="tpNfDev" size="125" style="width: 100%;" readonly="true" required="false" data-dojo-type="dijit/form/ValidationTextBox" disabled="disabled" />
                                        </td>
                                        <td style="width: 5%; text-align: left;" class="nowrap">
                                            <input id="pesNFDev" style="min-width: 18px" />
                                            <input type="text" id="limparNFDev" />
                                        </td>

                                    </table>
                                </td>

                                <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 13%;">
                                    <label for="statusCad">Status:</label>
                                </td>
                                <td colspan="2" class="dojoTextBoxIECorrect">
                                    <input data-dojo-type="dijit/form/FilteringSelect" required="false" id="_tipoStatus" style="width: 90%;" />
                                </td>
                            </tr>
                            <tr class="Pesquisa">
                                <td class="tdRight" style="width:5%;">
                                    <label for="item">Item:</label>
                                </td>
                                <td style="width: 45%;" class="nowrap">
                                    <input type="hidden" id="cd_item_pesq" />
                                    <table class="Table">
                                        <td class="dojoTextBoxIECorrect" style="width: 95%;">
                                            <input type="text" id="item_pesq" disabled="disabled" name="item_pesq" style="width: 100%;" data-dojo-type="dijit/form/TextBox" />
                                        </td>
                                        <td style="width: 5%; text-align: left" class="nowrap">
                                            <input id="pesProItemFK" style="min-width: 18px"/>
                                            <input type="text" id="limparItemFiltroFK"/>
                                        </td>
                                        
                                    </table>
                                </td>
                                <td rowspan="2"></td>
                                
                            </tr>
                        </table>

                        <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Período da Data Inicial/Data Final'" id="paneDataInicial" open="false">
                            <table class="Table">
                                <tr>
                                    <td class="tdRight" style="width: 12%;">
                                        <label for="dtaIni">Data Inicial:</label>
                                    </td>
                                    <td style="width: 35%;" class="dojoTextBoxIECorrect">
                                        <input id="dtaIni"
                                               data-dojo-type="dijit/form/DateTextBox"
                                               style="width: 100%"
                                               class="alignDojoData"
                                               onblur="limparDateHoraTextBox(this)" name="dtaIni"
                                               onkeypress="mascaraDataHora(event, this)" maxlength="10" />
                                    </td>

                                    <td class="tdRight" style="width: 12%;">
                                        <label for="dtaFim">Data Final:</label>
                                    </td>
                                    <td style="width: 35%;" class="dojoTextBoxIECorrect">
                                        <input id="dtaFim"
                                               data-dojo-type="dijit/form/DateTextBox"
                                               style="width: 100%" class="alignDojoData"
                                               onblur="limparDateHoraTextBox(this)" name="dtaFim"
                                               onkeypress="mascaraDataHora(event, this)" maxlength="10" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
                <td style="width: 5%; text-align: center">
                    <input id="pesquisarPerdaMaterial" />
                </td>
            </tr>
        </table>
    </div>
    <div style="padding-top:10px">
        <div class="linha_acoes" style="width: 100%"></div>
        <div>
            <table style="width:100%">
                <tr style="width:100%">
                    <td style="text-align:left; width:25%">
                        <div class="linkAcoes" id="linkAcoesPerdaMaterial"></div>
                    </td>
                    <td style="text-align:center; width:50%;">
                        <input id="novoPerdaMaterial" title="Novo" />
                        <input id="relatorioPerdaMaterial" title="Relatório" />
                    </td>
                    <td style="text-align:right; width:25%">
                        <span class="linkSelecionados" id="linkSelecionadosPerdaMaterial"></span>
                    </td>
                </tr>
            </table>
        </div>
        <div class="linha_acoes" style="width: 100%"></div>
    </div>
</div>
<div data-dojo-type="dijit/layout/ContentPane" id="ContentGridPerdaMaterial" style="padding-left:0px; padding-right:0px;">
    <div class="gridCadBasic">
        <div id="gridPerdaMaterial"></div>
    </div>
</div>
<div id="cad" data-dojo-type="dijit.Dialog" title="Cadastro de PerdaMaterial" class="Dialogo">

    <div class="sessao_form" style="margin-left: -10px;">
        <span id="counter_form">Sua sess&atilde;o expira em 59 min 59 seg</span>
    </div>

    <div class="corpo_interno" style="max-width: 675px;">
        <!-- div de scroll para a tela nao estourar no 1024 com mensagens:-->
        <div class="scroll" style="width: 100%; height: 425px;">
            <div class="apresentadorMsg" id="apresentadorMensagemPerdaMaterial" style="display:none;"></div>
            <input id="cd_perda_material" name="cd_perda_material" type="hidden" value="0" />
            <div data-dojo-type="dijit/layout/TabContainer" id="tabContainer" class="Abas" style="height: 425px;">
                <div data-dojo-type="dijit/layout/ContentPane" title="Principal">
                    <form id="formPerdaMaterial" data-dojo-type="dojox/form/Manager" enctype="multipart/form-data" class="Formulario">
                        <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'PerdaMaterial'">
                            <table class="Table">
                                <tr>
                                    <td class="tdRight" style="width: 5%;">
                                        <label id="lbNotaDevolver">Movimento:</label>
                                    </td>
                                    <td colspan="3"  style="width: 100%;" class="nowrap">
                                        <input id="cd_nfDevCad" type="hidden" value="0"/>
                                        <input id="id_tipo_movimentoCad" type="hidden" value="0"/>
                                        <table class="Table">

                                            <td class="dojoTextBoxIECorrect" style="width: 95%;">
                                                <input id="tpNfDevCad" name="tpNfDevCad" size="125" style="width: 100%;" readonly="true" required="false" data-dojo-type="dijit/form/ValidationTextBox" disabled="disabled"/>
                                            </td>
                                            <td style="width: 5%; text-align: left;" class="nowrap">
                                                <input id="pesNFDevCad" style="min-width: 18px"/>
                                                <input type="text" id="limparNFDevCad"/>
                                            </td>

                                        </table>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td class="tdRight">Aluno:</td>
                                    <td colspan="3"  class="dojoTextBoxIECorrect">
                                        <input id="cd_alunoCad" type="hidden" value="0"/>
                                        <input data-dojo-type="dijit/form/ValidationTextBox" id="nomeAlunoCad" name="nomeAlunoCad" maxlength="64" style="width: 100%" required="true" disabled="disabled"/>
                                    </td>

                                </tr>
                                <tr>
                                    <td class="tdRight">Contrato:</td>
                                    <td colspan="3" class="dojoTextBoxIECorrect">
                                        <input id="cd_contratoCad" type="hidden" value="0"/>
                                        <input data-dojo-type="dijit/form/ValidationTextBox" id="nomeIdContratoCad" name="nomeIdContratoCad" maxlength="64" style="width: 100%" required="true" disabled="disabled"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 15%;">
                                        <label>Data:</label></td>
                                    <td style="width: 30%" class="Table dojoTextBoxIECorrect">
                                        <input
                                            type="text" id="dt_perda_material"
                                            name="dt_perda_material" data-dojo-type="dijit.form.DateTextBox"
                                            style="width: 100%;"
                                            required="true"
                                            constraints="{min:'1900-01', max:'2079-06', datePattern:'dd/MM/yyyy'}"
                                            onkeypress="mascaraDataHora(event, this)" maxlength="10" />
                                    </td>
                                    <td class="CorpoFormAux AlinhaDireita nowrap" style="width: 13%;">
                                        <label for="statusCad">Status:</label>
                                    </td>
                                    <td class="dojoTextBoxIECorrect">
                                        <input data-dojo-type="dijit/form/FilteringSelect" required="false" id="statusCad" style="width: 90%;" disabled="disabled"/>
                                    </td>
                                </tr>

                            </table>
                        </div>
                        
                        <div data-dojo-type="dijit/TitlePane" data-dojo-props="title: 'Itens'" id="material" open="true">

                            <div style="padding-top: 10px">
                                
                                <div>
                                    <table style="width: 100%">
                                        <tr style="width: 100%">
                                            <td style="text-align: left; width: 25%;">
                                                <div class="linkAcoes" id="linkAcoesMatDid"></div>
                                            </td>
                                            
                                            <td style="text-align: right; width: 25%;"></td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="linha_acoes" style="width: 100%"></div>
                            </div>

                            <div data-dojo-type="dijit/layout/ContentPane" id="tabContainerGridMaterial" style="width:100%; height:210px; padding: 5px 0px 0px 0px;">
                                <div id="gridItemsMovimentoMaterialDidatico"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <br />
        <div class="CaixaAcao">
            <div class="linha_acoes" style="width: 100%"></div>
            <div class="Alinhamento">
                <span id="divIncluirPerdaMaterial">
                    <input id="incluirPerdaMaterial" title="incluir" />
                </span>
                <span id="divAlterarPerdaMaterial">
                    <input id="alterarPerdaMaterial" title="Alterar" />
                </span>
                <span id="divExcluirPerdaMaterial">
                    <input type="button" id="deletePerdaMaterial" title="Apagar" />
                </span>
                <span id="divLimparPerdaMaterial">
                    <input id="limparPerdaMaterial" title="Limpar" />
                </span>
                <span id="divCancelarPerdaMaterial">
                    <input type="button" id="cancelarPerdaMaterial" title="Cancelar" />
                </span>
                <span id="divFecharPerdaMaterial">
                    <input type="button" id="fecharPerdaMaterial" title="Fechar" />
                </span>
            </div>
            <div class="linha_acoes" style="width: 100%"></div>
        </div>

    </div>
</div>
<div class="clear"></div>






<div id="fkItem" data-dojo-type="dijit.Dialog" title="Pesquisar Item" style="display: none; width: 700px; height: 590px;">
    <div style="width: 685px;height: 590px;">
        @Html.Partial("../Financeiro/ItemFK")
    </div>
</div>

<div id="fkPessoaPesq" data-dojo-type="dijit.Dialog" title="Pesquisar Pessoa" style="display: none; width: 800px; height: 590px;">
    <div style="height:590px;width:780px">
        @Html.Partial("../Pessoa/PessoaFK")
    </div>
</div>

<div id="cadPlanoContas" data-dojo-type="dijit.Dialog" title="Pesquisar Plano de Contas" style="display: none; width: 700px; height: 590px;">
    <div style="width: 685px; height: 590px;">
        @Html.Partial("../Financeiro/PlanoContasFK")
    </div>
</div>

<div id="proMvtoFK" data-dojo-type="dijit.Dialog" title="Pesquisar Movimento" style="display: none; width: 800px; height: 630px;">
    <input id="apresentadorMensagemFks" type="hidden">
    <div class="apresentadorMsg" id="apresentadorMensagemMvtoFK" style="display: none;"></div>
    <div style="width: 785px; height: 590px; max-height: 590px;overflow-y: auto;overflow-x: hidden">
        @Html.Partial("../Secretaria/MovimentoFK")
    </div>
</div>

<div id="proAluno" data-dojo-type="dijit.Dialog" title="Pesquisar Aluno" style="display: none; width: 700px; height: 590px;">
    <div style="width: 685px;height: 590px;">
        @Html.Partial("../Secretaria/AlunoFK")
    </div>

</div>